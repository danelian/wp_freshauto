// document.addEventListener("DOMContentLoaded",function(){window.addEventListener("scroll",()=>{const e=document.getElementById("header");300<=window.scrollY?e.classList.add("active"):e.classList.remove("active")});const t=document.querySelector("body"),s=document.querySelector("#burger-menu"),e=document.querySelector("#burger-open"),r=document.querySelector("#burger-close"),o=document.querySelectorAll(".header__menu>li>a, .header__bar a");e.addEventListener("click",()=>{s.classList.add("show"),t.classList.add("dis-scroll")}),r.addEventListener("click",()=>{s.classList.remove("show"),t.classList.remove("dis-scroll")}),o.forEach(e=>e.addEventListener("click",()=>{s.classList.remove("show"),t.classList.remove("dis-scroll")})),document.addEventListener("click",e=>{e.target.matches("#burger-menu, #burger-open, #burger-open img")||(s.classList.remove("show"),t.classList.remove("dis-scroll"))});new Swiper(".acardSwiper",{spaceBetween:10,pagination:{el:".swiper-pagination"}}),new Swiper(".whoareweSwiper",{spaceBetween:10,pagination:{el:".swiper-pagination"}});var n=new Swiper(".productSecondSwiper",{spaceBetween:10,slidesPerView:5,freeMode:!0,watchSlidesProgress:!0,pagination:{el:".swiper-pagination",type:"progressbar"}});new Swiper(".productMainSwiper",{spaceBetween:10,pagination:{el:".swiper-pagination"},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},thumbs:{swiper:n}});const c=document.querySelector(".catalog__left"),l=document.querySelector(".catalog__left-head"),i=document.querySelector(".catalog__left-content");c&&l.addEventListener("click",()=>{c.classList.contains("open")?(c.classList.remove("open"),i.removeAttribute("style")):(c.classList.add("open"),i.style.height=i.scrollHeight+"px")}),$(".js-select2").select2({dropdownPosition:"below",closeOnSelect:!0,language:{noResults:function(){return"Ничего не найдено"}}}),$("#select-marka").select2({placeholder:"Марка"}),$("#select-model").select2({placeholder:"Модель"}),$(".js-select2").one("select2:open",function(e){$("input.select2-search__field").prop("placeholder","Поиск")}),$("#select-orderby").select2({placeholder:"Выберите очередность",minimumResultsForSearch:-1})});

document.addEventListener('DOMContentLoaded', function(){

  // ------------------- BURGER MENU ---------------------
  const body = document.querySelector('body'),
        burgerMenu = document.querySelector('#burger-menu'),
        burgerOpen = document.querySelector('#burger-open'),
        burgerClose = document.querySelector('#burger-close'),
        burgerLinks = document.querySelectorAll('.header__menu>li>a, .header__bar a');
  burgerOpen.addEventListener('click', () => {
    burgerMenu.classList.add('show');
    body.classList.add('dis-scroll');
  })
  burgerClose.addEventListener('click', () => {
    burgerMenu.classList.remove('show');
    body.classList.remove('dis-scroll')
  })
  burgerLinks.forEach(n => n.addEventListener('click', () => {
    burgerMenu.classList.remove('show');
    body.classList.remove('dis-scroll')
  }))
  // document.addEventListener('click', (event) => {
  //   if (!event.target.matches("#burger-menu, #burger-open, #burger-open img")) {
  //     burgerMenu.classList.remove('show');
  //     body.classList.remove('dis-scroll')
  //   }
  // })


  // ---------------------- SWIPER ------------------------
  var whoareweSwiper = new Swiper(".whoareweSwiper", {
    spaceBetween: 10,
    pagination: {
      el: ".swiper-pagination",
    },
  });

  var swiper = new Swiper(".productSecondSwiper", {
    spaceBetween: 10,
    slidesPerView: 5,
    freeMode: true,
    watchSlidesProgress: true,
    pagination: {
      el: ".swiper-pagination",
      type: "progressbar",
    },
  });
  var swiper2 = new Swiper(".productMainSwiper", {
    spaceBetween: 10,
    pagination: {
      el: ".swiper-pagination",
    },
    navigation: {
      nextEl: ".swiper-button-next",
      prevEl: ".swiper-button-prev",
    },
    thumbs: {
      swiper: swiper,
    },
  });


  // --------------- CATALOG FILTERS FORM ----------------
  if (window.innerWidth <= 1024) {
    const catalogLeft = document.querySelector('.catalog__left'),
    catalogLeftHead = document.querySelector('.catalog__left-head'),
    catalogLeftForm = document.querySelector('.catalog__left-content');
    catalogLeftHead.addEventListener('click', () => {
      if (catalogLeft.classList.contains('open')) {
        catalogLeft.classList.remove('open');
        catalogLeftForm.removeAttribute('style');
      } else {
        catalogLeft.classList.add('open');
        catalogLeftForm.style.height = catalogLeftForm.scrollHeight + 'px';
      }
    })
  }


  // ---------------------- SELECT2 ------------------------
  $(".js-select2").select2({
    dropdownPosition: 'below',
    closeOnSelect: true,
    language: {
      noResults: function () {
        // return "Ничего не найдено";
        return myScriptData.select_nofound;
      },
    }
  });
  $('.js-select2').one('select2:open', function(e) {
    $('input.select2-search__field').prop('placeholder', myScriptData.select_search);
  });
  $("#select-marka").select2({
    placeholder: myScriptData.select_brand_placeholder
  });
  $("#select-model").select2({
    placeholder: myScriptData.select_model_placeholder
  });
  $("#select-orderby").select2({
    placeholder: myScriptData.select_orderby_placeholder,
    minimumResultsForSearch: -1
  });

  if (window.innerWidth > 1024) {
    $(".acard__thumb").brazzersCarousel();
  }

})

// -------------------------modal----------------------
$('.to-state').on('click', function (event) {
	event.preventDefault();
	$('div').removeClass('active');
	$('.state').removeClass('active');
	var state = $(this).attr('data-state');
	$('.state[data-state=' + state + ']').addClass('active');
});
$('.close').on('click', function (event) {
	$(this).parents().removeClass('active');
});
jQuery(function ($) {
	$(document).mouseup(function (e) { // событие клика по веб-документу
		var div = $(".state-box"); // тут указываем ID элемента
		if (!div.is(e.target) // если клик был не по нашему блоку
			&& div.has(e.target).length === 0) { // и не по его дочерним элементам
			div.parents().removeClass('active'); // скрываем его
			$('body').removeClass('modal-open');
		}
	});
});

if (window.innerWidth <= 1024) {
  if ($('.acardSwiper').length > 0) { //some-slider-wrap-in
    let swiperInstances = [];
    $(".acardSwiper").each(function (index, element) { //some-slider-wrap-in
      const $this = $(this);
      $this.addClass("instance-" + index); //instance need to be unique (ex: some-slider)
      $this.parent().find(".swiper-pagination").addClass("pagination-" + index);
      swiperInstances[index] = new Swiper(".instance-" + index, { //instance need to be unique (ex: some-slider)
        spaceBetween: 10,
        pagination: {
          el: '.pagination-' + index,
          clickable: true
        },
      });
    });

    // Now you can call the update on a specific instance in the "swiperInstances" object
    // e.g.
    swiperInstances[3].update();
    //or all of them
    setTimeout(function () {
      for (const slider of swiperInstances) {
        slider.update();
      }
    }, 50);
  }
}